<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Extending climaemet • climaemet</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="extending-climaemet_files/libs/quarto-html/popper.min.js"></script><script src="extending-climaemet_files/libs/quarto-html/tippy.umd.min.js"></script><link href="extending-climaemet_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="extending-climaemet_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extending climaemet">
<meta property="og:image" content="https://ropenspain.github.io/climaemet/logo.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@mpizarrozgz">
<meta name="twitter:site" content="@rOpenSpain">
<!-- rogtemplate style sheet --><link href="../BS5/rostemplate.min.css" rel="stylesheet">
</head>
<body>
  <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


  <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html"><img src="../apple-touch-icon.png" alt="climaemet logo" height="34" width="34" class="d-inline-block me-1">climaemet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/climaemet.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/extending-climaemet.html">Extending climaemet</a></li>
    <li><a class="dropdown-item" href="../articles/aemet_stations.html">AEMET Stations</a></li>
    <li><a class="dropdown-item" href="../articles/api_metadata.html">API Metadata</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Predictions</h6></li>
    <li><a class="dropdown-item" href="../articles/interpolation.html">Spatial Interpolation with climaemet</a></li>
    <li><a class="dropdown-item" href="../articles/dealing_spatial.html">Dealing with spatial data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rOpenSpain/climaemet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
    <div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Extending climaemet</h1>




      <small class="dont-index">Source: <a href="https://github.com/rOpenSpain/climaemet/blob/main/vignettes/extending-climaemet.qmd" class="external-link"><code>vignettes/extending-climaemet.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <!-- extending-climaemet.qmd is generated from extending-climaemet.qmd.orig. Please edit that file --><p><strong>climaemet</strong> provides several functions for accessing a selection of endpoints of the <a href="https://opendata.aemet.es/dist/index.html?" class="external-link">AEMET API tool</a>. However, this package does not cover in full all the capabilities of the API.</p>
<p>For that reason, we provide the <code><a href="../reference/get_data_aemet.html">get_data_aemet()</a></code> function, that allows to access any API endpoint freely. The drawback is that the user would need to handle the results by him/herself.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ropenspain.github.io/climaemet/">climaemet</a></span><span class="op">)</span></span></code></pre></div>
<section class="level2"><h2 id="example-normalized-text">Example: Normalized text<a class="anchor" aria-label="anchor" href="#example-normalized-text"></a>
</h2>
<p>Some API endpoints, as <code>predicciones-normalizadas-texto</code>, provides the results as plain text on natural language. These results are not parsed by <strong>climaemet</strong>, but can be retrieved as this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># endpoint, today forecast</span></span>
<span></span>
<span><span class="va">today</span> <span class="op">&lt;-</span> <span class="st">"/api/prediccion/nacional/hoy"</span></span>
<span></span>
<span><span class="co"># Metadata</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_data_aemet.html">get_metadata_aemet</a></span><span class="op">(</span><span class="va">today</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table caption-top">
<colgroup>
<col style="width: 8%">
<col style="width: 24%">
<col style="width: 39%">
<col style="width: 1%">
<col style="width: 18%">
<col style="width: 6%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">unidad_generadora</th>
<th style="text-align: left;">descripcion</th>
<th style="text-align: left;">periodicidad</th>
<th style="text-align: left;">formato</th>
<th style="text-align: left;">copyright</th>
<th style="text-align: left;">notaLegal</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">Grupo Funcional de Predicción de Referencia</td>
<td style="text-align: left;">Predicción general nacional para hoy / mañana / pasado mañana / medio plazo (tercer y cuarto día) / tendencia (del quinto al noveno día)</td>
<td style="text-align: left;">Disponibilidad. Para hoy, solo se confecciona si hay cambios significativos. Para mañana y pasado mañana diaria a las 15:00 h.o.p.. Para el medio plazo diaria a las 16:00 h.o.p.. La tendencia, diaria a las 18:30 h.o.p.</td>
<td style="text-align: left;">ascii/txt</td>
<td style="text-align: left;">© AEMET. Autorizado el uso de la información y su reproducción citando a AEMET como autora de la misma.</td>
<td style="text-align: left;">https://www.aemet.es/es/nota_legal</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Data</span></span>
<span><span class="va">pred_today</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_data_aemet.html">get_data_aemet</a></span><span class="op">(</span><span class="va">today</span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ Results are MIME type: "text/plain".</span></span>
<span><span class="co">#&gt; → Returning data as UTF-8 string.</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Produce a result</span></span>
<span></span>
<span><span class="va">clean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\r"</span>, <span class="st">"\n"</span>, <span class="va">pred_today</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">clean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\n\n\n"</span>, <span class="st">"\n"</span>, <span class="va">clean</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"&lt;blockquote&gt;"</span>, <span class="va">clean</span>, <span class="st">"&lt;/blockquote&gt;"</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>AGENCIA ESTATAL DE METEOROLOGÍA PREDICCIÓN GENERAL PARA ESPAÑA DÍA 18 DE FEBRERO DE 2026 A LAS 07:28 HORA OFICIAL PREDICCIÓN VÁLIDA PARA EL MIÉRCOLES 18</p>
<p>A.- FENÓMENOS SIGNIFICATIVOS Precipitaciones que pueden ser puntualmente fuertes o persistentes en Galicia. Rachas muy fuertes en Galicia, Cantábrico, Castilla y León y tercio este peninsular.</p>
<p>B.- PREDICCIÓN Se prevé el paso de un frente por la Península que, de oeste a este, tenderá a dejar cielos nubosos o cubiertos en la mayor parte del territorio, con un predominio de cielos poco nubosos o con intervalos de nubes altas en los tercios este y sureste, así como en Baleares durante la mayor parte del día. Este frente, y la posterior descarga fría, dejarán precipitaciones en la mitad norte de la vertiente atlántica, área cantábrica, alto Ebro y entorno pirenaico, pudiendo afectar a otras regiones a excepción del este y sureste. Se prevén más abundantes cuanto más al noroeste, pudiendo ser fuertes o persistentes en el oeste de Galicia. Asimismo, podrá darse alguna tormenta ocasional en regiones del norte peninsular. Nevará a una cota de 1200-1500 metros, disminuyendo a 900-1200m en el extremo norte y a una cota de 1500/1900m en el resto. Cielos poco nubosos o despejados en Canarias.</p>
<p>Probables nieblas matinales en las campiñas del sur de Andalucía, meseta así como en zonas bajas del nordeste. Brumas frontales en el noroeste peninsular. Posibles restos de calima ligera en Canarias.</p>
<p>Las temperaturas descenderán en la mayor parte del país, exceptuando las máximas, que aumentarán en el Cantábrico oriental, Pirineo y nordeste de Cataluña. Heladas localmente débiles en el Pirineo.</p>
<p>Predominará viento moderado de componentes oeste y sur en la Península y Baleares, en general flojo en interiores del tercio nordeste y suroeste peninsular y con intensidad fuerte en litorales del extremo noroeste y Alborán. Se esperan rachas muy fuertes en Galicia, Cantábrico y Castilla y León. También a últimas horas en el tercio oriental peninsular. En Canarias, alisio con intervalos de fuerte en zonas expuestas.</p>
</blockquote>
</section><section class="level2"><h2 id="example-maps">Example: Maps<a class="anchor" aria-label="anchor" href="#example-maps"></a>
</h2>
<p>AEMET also provides map data, usually on <code>image/gif</code> format. One way to get this kind of data is as follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Endpoint of a map</span></span>
<span><span class="va">a_map</span> <span class="op">&lt;-</span> <span class="st">"/api/mapasygraficos/analisis"</span></span>
<span></span>
<span><span class="co"># Metadata</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_data_aemet.html">get_metadata_aemet</a></span><span class="op">(</span><span class="va">a_map</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table caption-top">
<colgroup>
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 28%">
<col style="width: 3%">
<col style="width: 32%">
<col style="width: 11%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">unidad_generadora</th>
<th style="text-align: left;">descripción</th>
<th style="text-align: left;">periodicidad</th>
<th style="text-align: left;">formato</th>
<th style="text-align: left;">copyright</th>
<th style="text-align: left;">notaLegal</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">Grupo Funcional de Jefes de Turno</td>
<td style="text-align: left;">Mapas de análisis de frentes en superficie</td>
<td style="text-align: left;">Dos veces al día, a las 02:00 y 14:00 h.o.p. en invierno y a las 03:00 y 15:00 en verano.</td>
<td style="text-align: left;">image/gif</td>
<td style="text-align: left;">© AEMET. Autorizado el uso de la información y su reproducción citando a AEMET como autora de la misma.</td>
<td style="text-align: left;">https://www.aemet.es/es/nota_legal</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">the_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_data_aemet.html">get_data_aemet</a></span><span class="op">(</span><span class="va">a_map</span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ Results are MIME type: "image/gif".</span></span>
<span><span class="co">#&gt; → Returning &lt;raw&gt; bytes. See also `base::writeBin()`.</span></span>
<span></span>
<span><span class="co"># Write as gif and include it</span></span>
<span><span class="va">giffile</span> <span class="op">&lt;-</span> <span class="st">"example-gif.gif"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readBin.html" class="external-link">writeBin</a></span><span class="op">(</span><span class="va">the_map</span>, <span class="va">giffile</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display on the vignette, it may be rotated</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html" class="external-link">include_graphics</a></span><span class="op">(</span><span class="va">giffile</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="example-gif.gif" alt="Example: Surface analysis map provided by AEMET" width="100%"><p class="caption">
Example: Surface analysis map provided by AEMET
</p>
</div>
</section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>

  </div>

  <!-- ropenspain rostemplate -->
<footer id="footer"><div class="container">
    <div class="row">
      <div class="col-md">
        <h4 data-toc-skip>About <img src="../logo.png" alt="climaemet Logo" height="24" class="round-logo">
          climaemet</h4>
        <p>Developed by <a href="https://github.com/mpizarrotig" class="external-link">Manuel Pizarro</a>, <a href="https://dieghernan.github.io/" class="external-link">Diego Hernangómez</a>, <a href="https://blog.uclm.es/gemafaviles/" class="external-link">Gema Fernández-Avilés</a>. <br>Part of the <span class="ROS-light">rOpenSpain</span> project.
</p>
        <hr class="d-md-none">
</div>
      <div class="col-md offset-md-4">
        <h4 data-toc-skip>About <img src="../ROS-logo.png" alt="ROpenSpain Logo" height="24" class="round-logo"><span class="ROS-light">
            rOpenSpain</span>
</h4>
        <p><a href="https://ropenspain.es/" class="external-link"><span class="ROS-light">rOpenSpain</span></a> is a community of
          enthusiasts
          of <strong>R</strong>, open data, and reproducibility that comes
          together and organizes itself to create <strong>R</strong> packages of
          the highest quality for the analysis
          and use of Spanish data of general interest.
        </p>
        <p class="fst-italic text-md-end">"rOpenSci is our form, Spanish public
          data our matter"</p>
        <hr class="d-md-none">
</div>
    </div>
  </div>
</footer><div id="copyright">
  <div class="container">
    <div class="row">
      <div class="col-md text-center text-md-start">
        <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
      </div>
      <div class="col-md offset-md-4 text-center text-md-start lh-base">
        <p>Template <a href="https://ropenspain.github.io/rostemplate/" class="external-link">rostemplate</a> by
          <a href="https://github.com/dieghernan/" class="external-link">dieghernan</a>, based on <a href="https://devcows.github.io/hugo-universal-theme/" class="external-link">Universal
            Theme for Hugo</a>.
        </p>
      </div>
    </div>
  </div>
</div>




  <script>
  var h1s = document.getElementsByTagName("h1");
  var myH1;
  if (h1s.length > 0) {
    myH1 = h1s[0];
    myH1.classList.add("ROSh1");
  }
</script>
</body>
</html>
